{% extends "base.html" %}
{% block title %}Inbox{% endblock title %}
{% block style %} <link rel="stylesheet" href="{{url_for('static',filename='css/user_panel.css')}}"> {% endblock style %}

{% block content %}
<div class="messages-container">
    <div class="page-header">
        <div class="back-button">
            <a href="{{ url_for('user_panel') }}" class="btn-back">
                <i class="fas fa-arrow-left"></i> Previous Page
            </a>
        </div>
        <h1>Inbox</h1>
        <p>View the support requests you’ve submitted</p>
    </div>

    {% if messages %}
        <div class="messages-grid">
            {% for message in messages %}
            <div class="message-card" onclick="window.location.href='{{ url_for('panel_message_detail', id=message.id) }}'">
                <div class="message-header">
                    <div class="message-status">
                        {% if message.read %}
                            <span class="status-badge active">
                                <i class="fas fa-check-circle"></i> Replied
                            </span>
                        {% else %}
                            <span class="status-badge inactive">
                                <i class="fas fa-clock"></i> Awaiting Response
                            </span>
                        {% endif %}
                    </div>
                    <div class="message-date">
                        <i class="fas fa-calendar-alt"></i>
                        {{ message.created_at.strftime('%d.%m.%Y') if message.created_at else 'Tarih belirtilmemiş' }}
                    </div>
                </div>
                
                <div class="message-content">
                    <div class="message-subject">
                        <h3><i class="fas fa-envelope-open"></i> {{ message.subject }}</h3>
                    </div>
                    
                    <div class="message-preview">
                        <div class="preview-label">
                            <i class="fas fa-comment"></i> Preview Message:
                        </div>
                        <p>{{ message.message[:100] }}{% if message.message|length > 100 %}...{% endif %}</p>
                    </div>
                    
                    <div class="message-meta">
                        <div class="meta-item">
                            <i class="fas fa-user-circle"></i>
                            <span><strong>Sender:</strong> {{ message.name }} {{ message.surname }}</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-envelope"></i>
                            <span><strong>Email Address:</strong> {{ message.email }}</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-hashtag"></i>
                            <span><strong>Message Number: {{ message.id }}</strong></span>
                        </div>
                    </div>
                </div>
                
                <div class="message-footer">
                    <div class="click-hint">
                        <i class="fas fa-hand-pointer"></i>
                        <span>Tap here to see more information</span>
                    </div>
                    <div class="message-actions">
                        <span class="action-btn">
                            <i class="fas fa-eye"></i> View
                        </span>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
    <!-- Hızlı İstatistikler -->
    <div class="quick-stats">
        <div class="stat-item">
            <div class="stat-icon">
                <i class="fas fa-envelope"></i>
            </div>
            <div class="stat-content">
                <div class="stat-number">{{ messages|length if messages else 0 }}</div>
                <div class="stat-label">Total Messages</div>
            </div>
        </div>
        <div class="stat-item">
            <div class="stat-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-content">
                <div class="stat-number">{{read_true if read_true else 0 }}</div>
                <div class="stat-label">Replied Message</div>
            </div>
        </div>
        <div class="stat-item">
            <div class="stat-icon">
                <i class="fas fa-clock"></i>
            </div>
            <div class="stat-content">
                <div class="stat-number">{{read_false if read_false else 0}}</div>
                <div class="stat-label">Awaiting Response</div>
            </div>
        </div>
    </div>
    {% else %}
        <div class="no-messages">
            <div class="no-messages-icon">
                <i class="fas fa-inbox"></i>
            </div>
            <h3>You don’t have any messages yet</h3>
            <p>Need help? Head to our contact page to send a support request</p>
            <a href="{{ url_for('contact') }}" class="btn btn-primary">
                <i class="fas fa-plus"></i> New Message
            </a>
        </div>
    {% endif %}
</div>
{% endblock content %}
